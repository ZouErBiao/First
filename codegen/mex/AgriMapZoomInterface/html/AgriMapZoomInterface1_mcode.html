<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%% 接口函数---缩放算法</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">ver</span>,<span class="var type1" id="S3T2U4">out</span>,<span class="var type1" id="S4T3U5">mapOut</span>] = AgriMapZoomInterface(<span class="var type1" id="S5T6U8">mapB</span>,<span class="var type1" id="S6T8U9">lineM</span>,<span class="var type1" id="S7T9U10">params</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment"><span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">作用:进行坐标转换、单边内外平移、多边形整体外扩或内缩</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">输入:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">整体</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">mapB.mapCnt:输入的点的个数(数据类型:uint8 1x1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">mapB.mapLat:点的横坐标(数据类型:double 1x100)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">mapB.mapLon:点的纵坐标(数据类型:double 1x100)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">mapB.mapAlt:高度(double-1*100)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">mapB.L:缩放距离(数据类型：double 1x1)，只保证L值连续变化时的调用满足预期；</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">mapB.flag:缩放标志，内缩外扩标志位，0:内缩，1;外扩，若输入其他值，则会有相应的警告！(数据类型:double 1x1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">单边</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">LineM.Monolateral:单边移动边界号，形如;1,2,3,4,5,...<span class="comment">nn(数据类型:double 1x1)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">LineM.Monolateral_L:单边移动距离(数据类型:double 1x1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">LineM.Monolateral_flag:移动方向，0:内移，1:外移;(数据类型:double 1x1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">params.Theita: 被认为是小锐角的角度界限，格式如：“20”，代表各顶点小于或等于20°为小锐角，需要处理；范围为0°到90°(数据类型：double 1x1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">params.mapFlag:平面坐标标志,0为平面坐标，1为经纬度坐标(数据类型：double 1x1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">params.L0:所有地块点的经度平均值(double)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">输出:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">mapOut.mapCnt</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">mapOut.mapLat</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">mapOut.mapLon:处理后的多边形边界点</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">mapOut.mapAlt</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">out.error:（错误码）</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">-0正常</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">-(-1)不予处理,边界交叉</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">out.warn:警告码</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">-0正常</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">-1异常</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">f_Warning0:经纬度转换标志无效</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">f_Warning1:单边移动无效(所选边序号无效+移动标志无效)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">f_Warning2:整体缩放无效(移动标志无效)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">ver:版本号</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%% 配置</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo " id="T7:U7"><span class="var type1" id="S8T7U13">mapTransfMethod</span> = <span class="mxinfo " id="T7:U9">0</span></span>;<span class="comment">%经纬度转换算法</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%% 初始化</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo " id="T1:U10"><span class="var type1" id="S2T1U17">ver</span> = <span class="mxinfo " id="T1:U12">int32(<span class="mxinfo " id="T7:U13">201</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="mxinfo " id="T1:U14"><span class="mxinfo " id="T1:U15"><span class="var type1" id="S3T2U24">out</span>.error</span> = <span class="mxinfo " id="T1:U17">int32(<span class="mxinfo " id="T7:U18">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo " id="T1:U19"><span class="mxinfo " id="T1:U20"><span class="var type1" id="S3T2U32">out</span>.warn</span> = <span class="mxinfo " id="T1:U22">int32(<span class="mxinfo " id="T7:U23">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo " id="T7:U24"><span class="var type1" id="S10T7U39">MAX_MAP_POINTS</span> = <span class="mxinfo " id="T7:U26">100</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="mxinfo " id="T4:U27"><span class="mxinfo " id="T4:U28"><span class="var type1" id="S4T3U44">mapOut</span>.mapCnt</span> = <span class="mxinfo " id="T4:U30">uint8(<span class="mxinfo " id="T7:U31">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo " id="T5:U32"><span class="mxinfo " id="T5:U33"><span class="var type1" id="S4T3U52">mapOut</span>.mapLat</span> = <span class="mxinfo " id="T5:U35">zeros(<span class="mxinfo " id="T7:U36">1</span>,<span class="var type1" id="S10T7U57">MAX_MAP_POINTS</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo " id="T5:U38"><span class="mxinfo " id="T5:U39"><span class="var type1" id="S4T3U61">mapOut</span>.mapLon</span> = <span class="mxinfo " id="T5:U41">zeros(<span class="mxinfo " id="T7:U42">1</span>,<span class="var type1" id="S10T7U66">MAX_MAP_POINTS</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo " id="T5:U44"><span class="mxinfo " id="T5:U45"><span class="var type1" id="S4T3U70">mapOut</span>.mapAlt</span> = <span class="mxinfo " id="T5:U47">zeros(<span class="mxinfo " id="T7:U48">1</span>,<span class="var type1" id="S10T7U75">MAX_MAP_POINTS</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo " id="T7:U50"><span class="var type1" id="S13T7U78">mapCnt</span> = <span class="mxinfo " id="T7:U52">double(<span class="mxinfo " id="T4:U53"><span class="var type1" id="S5T6U82">mapB</span>.mapCnt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo " id="T11:U55"><span class="var type1" id="S15T11U86">Points</span> = <span class="mxinfo " id="T11:U57">zeros(<span class="mxinfo " id="T12:U58">2</span>,<span class="var type1" id="S13T7U90">mapCnt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%Pointmap = zeros(mapCnt,2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo " id="T13:U60"><span class="var type1" id="S16T13U93">PreprocessingData</span> = <span class="mxinfo " id="T13:U62">zeros(<span class="var type1" id="S13T7U96">mapCnt</span>,<span class="mxinfo " id="T7:U64">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo " id="T7:U65"><span class="var type1" id="S17T7U100">PreprocessingCnt</span> = <span class="mxinfo " id="T7:U67">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo " id="T14:U68"><span class="var type1" id="S18T14U107">mapLat</span> = <span class="mxinfo " id="T14:U70">zeros(<span class="mxinfo " id="T7:U71">1</span>,<span class="var type1" id="S13T7U111">mapCnt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo " id="T14:U73"><span class="var type1" id="S19T14U114">mapLon</span> = <span class="mxinfo " id="T14:U75">zeros(<span class="mxinfo " id="T7:U76">1</span>,<span class="var type1" id="S13T7U118">mapCnt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="mxinfo " id="T7:U78"><span class="var type1" id="S20T7U121">L</span> = <span class="mxinfo " id="T7:U80">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="mxinfo " id="T7:U81"><span class="var type1" id="S21T7U128">flag</span> = <span class="mxinfo " id="T7:U83">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo " id="T7:U84"><span class="var type1" id="S22T7U135">Monolateral</span> = <span class="mxinfo " id="T7:U86">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo " id="T7:U87"><span class="var type1" id="S23T7U142">Monolateral_L</span> = <span class="mxinfo " id="T7:U89">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="mxinfo " id="T7:U90"><span class="var type1" id="S24T7U149">Monolateral_flag</span> = <span class="mxinfo " id="T7:U92">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo " id="T7:U93"><span class="var type1" id="S25T7U156">Theita</span> = <span class="mxinfo " id="T7:U95">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo " id="T7:U96"><span class="var type1" id="S26T7U163">mapFlag</span> = <span class="mxinfo " id="T7:U98">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="mxinfo " id="T7:U99"><span class="var type1" id="S27T7U170">L0</span> = <span class="mxinfo " id="T7:U101">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%% 入参</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo " id="T14:U102"><span class="mxinfo " id="T14:U103"><span class="var type1" id="S18T14U178">mapLat</span>(<span class="mxinfo " id="T12:U105">1</span>,<span class="mxinfo " id="T15:U106"><span class="mxinfo " id="T7:U107">1</span>:<span class="var type1" id="S13T7U182">mapCnt</span></span>)</span> = <span class="mxinfo " id="T16:U109"><span class="mxinfo " id="T5:U110"><span class="var type1" id="S5T6U185">mapB</span>.mapLat</span>(<span class="mxinfo " id="T12:U112">1</span>,<span class="mxinfo " id="T17:U113"><span class="mxinfo " id="T7:U114">1</span>:<span class="var type1" id="S13T7U190">mapCnt</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo " id="T14:U116"><span class="mxinfo " id="T14:U117"><span class="var type1" id="S19T14U194">mapLon</span>(<span class="mxinfo " id="T12:U119">1</span>,<span class="mxinfo " id="T15:U120"><span class="mxinfo " id="T7:U121">1</span>:<span class="var type1" id="S13T7U198">mapCnt</span></span>)</span> = <span class="mxinfo " id="T16:U123"><span class="mxinfo " id="T5:U124"><span class="var type1" id="S5T6U201">mapB</span>.mapLon</span>(<span class="mxinfo " id="T12:U126">1</span>,<span class="mxinfo " id="T17:U127"><span class="mxinfo " id="T7:U128">1</span>:<span class="var type1" id="S13T7U206">mapCnt</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo " id="T14:U130"><span class="mxinfo " id="T14:U131"><span class="var type1" id="S15T11U210">Points</span>(<span class="mxinfo " id="T12:U133">1</span>,<span class="mxinfo " id="T18:U134">:</span>)</span> = <span class="mxinfo " id="T14:U135"><span class="var type1" id="S18T14U214">mapLat</span>(<span class="mxinfo " id="T12:U137">1</span>,<span class="mxinfo " id="T15:U138"><span class="mxinfo " id="T7:U139">1</span>:<span class="var type1" id="S13T7U218">mapCnt</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="mxinfo " id="T14:U141"><span class="mxinfo " id="T14:U142"><span class="var type1" id="S15T11U222">Points</span>(<span class="mxinfo " id="T12:U144">2</span>,<span class="mxinfo " id="T18:U145">:</span>)</span> = <span class="mxinfo " id="T14:U146"><span class="var type1" id="S19T14U226">mapLon</span>(<span class="mxinfo " id="T7:U148">1</span>,<span class="mxinfo " id="T15:U149"><span class="mxinfo " id="T7:U150">1</span>:<span class="var type1" id="S13T7U230">mapCnt</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="mxinfo " id="T7:U152"><span class="var type1" id="S20T7U234">L</span>(1,1) = <span class="mxinfo " id="T7:U154"><span class="var type1" id="S5T6U238">mapB</span>.L</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="mxinfo " id="T7:U156"><span class="var type1" id="S21T7U243">flag</span>(1,1) = <span class="mxinfo " id="T7:U158"><span class="var type1" id="S5T6U247">mapB</span>.flag</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo " id="T7:U160"><span class="var type1" id="S22T7U252">Monolateral</span>(1,1) = <span class="mxinfo " id="T4:U162"><span class="var type1" id="S6T8U256">lineM</span>.Monolateral</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="mxinfo " id="T7:U164"><span class="var type1" id="S23T7U261">Monolateral_L</span>(1,1) = <span class="mxinfo " id="T7:U166"><span class="var type1" id="S6T8U265">lineM</span>.Monolateral_L</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="mxinfo " id="T7:U168"><span class="var type1" id="S24T7U270">Monolateral_flag</span>(1,1) = <span class="mxinfo " id="T7:U170"><span class="var type1" id="S6T8U274">lineM</span>.Monolateral_flag</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="mxinfo " id="T7:U172"><span class="var type1" id="S25T7U279">Theita</span>(1,1) = <span class="mxinfo " id="T7:U174"><span class="var type1" id="S7T9U283">params</span>.Theita</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="mxinfo " id="T7:U176"><span class="var type1" id="S26T7U288">mapFlag</span>(1,1) = <span class="mxinfo " id="T10:U178"><span class="var type1" id="S7T9U292">params</span>.mapFlag</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="mxinfo " id="T7:U180"><span class="var type1" id="S27T7U297">L0</span>(1,1) = <span class="mxinfo " id="T7:U182"><span class="var type1" id="S7T9U301">params</span>.L0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">%% 预处理</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">%%进行转平面直角操作，并转变成两列坐标</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="mxinfo " id="T7:U184"><span class="var type1" id="S28T7U305">refLat</span> = <span class="mxinfo " id="T7:U186"><span class="var type1" id="S18T14U307">mapLat</span>(<span class="mxinfo " id="T7:U188">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="mxinfo " id="T7:U189"><span class="var type1" id="S29T7U311">refLon</span> = <span class="mxinfo " id="T7:U191"><span class="var type1" id="S19T14U313">mapLon</span>(<span class="mxinfo " id="T7:U193">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo " id="T7:U194"><span class="var type1" id="S30T7U317">earthR</span> = <span class="mxinfo " id="T7:U196">6371393</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo " id="T7:U197"><span class="var type1" id="S31T7U321">latR</span> = <span class="mxinfo " id="T7:U199"><span class="mxinfo " id="T7:U200">6371393</span>*<span class="mxinfo " id="T7:U201">cos(<span class="mxinfo " id="T7:U202"><span class="mxinfo " id="T7:U203"><span class="var type1" id="S28T7U328">refLat</span>*<span class="mxinfo " id="T7:U205">pi</span></span>/<span class="mxinfo " id="T7:U206">180</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="mxinfo " id="T7:U207"><span class="var type1" id="S34T7U334">f_Warning0</span> = <span class="mxinfo " id="T7:U209">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T19:U210"><span class="var type1" id="S26T7U343">mapFlag</span>(1,1) == <span class="mxinfo " id="T7:U212">1</span></span><span class="comment">%1为经纬度坐标，0为平面坐标</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S8T7U350">mapTransfMethod</span> == 1<span class="comment">%算法1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">        <span class="keyword">for</span> <span class="var type0" id="S35T0U354">i</span>=2:<span class="var type0" id="S13T0U357">mapCnt</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">            <span class="var type0" id="S15T0U361">Points</span>(1,<span class="var type0" id="S35T0U363">i</span>) = <span class="var type0" id="S30T0U367">earthR</span>*(<span class="var type0" id="S15T0U371">Points</span>(1,<span class="var type0" id="S35T0U373">i</span>)-<span class="var type0" id="S28T0U374">refLat</span>)*pi/180;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">            <span class="var type0" id="S15T0U381">Points</span>(2,<span class="var type0" id="S35T0U383">i</span>) = <span class="var type0" id="S31T0U387">latR</span>*(<span class="var type0" id="S15T0U391">Points</span>(2,<span class="var type0" id="S35T0U393">i</span>)-<span class="var type0" id="S29T0U394">refLon</span>)*pi/180;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">        <span class="var type0" id="S15T0U401">Points</span>(1,1)=0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">        <span class="var type0" id="S15T0U408">Points</span>(2,1)=0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">    <span class="keyword">else</span> <span class="comment">%算法2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S35T7U415">i</span>=<span class="mxinfo " id="T7:U215">1</span>:<span class="var type1" id="S13T7U418">mapCnt</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">            [<span class="mxinfo " id="T7:U217"><span class="var type1" id="S15T11U423">Points</span>(<span class="mxinfo " id="T7:U219">1</span>,<span class="var type1" id="S35T7U425">i</span>)</span>,<span class="mxinfo " id="T7:U221"><span class="var type1" id="S15T11U427">Points</span>(<span class="mxinfo " id="T7:U223">2</span>,<span class="var type1" id="S35T7U429">i</span>)</span>] = <span class="fcn" id="F83N3:B431">BL2XY_q</span>(<span class="mxinfo " id="T7:U225"><span class="var type1" id="S18T14U433">mapLat</span>(<span class="var type1" id="S35T7U434">i</span>)</span>,<span class="mxinfo " id="T7:U228"><span class="var type1" id="S19T14U436">mapLon</span>(<span class="var type1" id="S35T7U437">i</span>)</span>,<span class="var type1" id="S27T7U438">L0</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"><span class="comment">%除重和删除同一点操作</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"><span class="mxinfo " id="T20:U232"><span class="mxinfo " id="T20:U233"><span class="var type1" id="S16T13U442">PreprocessingData</span>(<span class="mxinfo " id="T15:U235"><span class="mxinfo " id="T7:U236">1</span>:<span class="var type1" id="S13T7U445">mapCnt</span></span>,<span class="mxinfo " id="T12:U238">1</span>)</span> = <span class="mxinfo " id="T20:U239"><span class="mxinfo " id="T14:U240"><span class="var type1" id="S15T11U449">Points</span>(<span class="mxinfo " id="T7:U242">1</span>,<span class="mxinfo " id="T15:U243"><span class="mxinfo " id="T7:U244">1</span>:<span class="var type1" id="S13T7U453">mapCnt</span></span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"><span class="mxinfo " id="T20:U246"><span class="mxinfo " id="T20:U247"><span class="var type1" id="S16T13U457">PreprocessingData</span>(<span class="mxinfo " id="T15:U249"><span class="mxinfo " id="T7:U250">1</span>:<span class="var type1" id="S13T7U460">mapCnt</span></span>,<span class="mxinfo " id="T12:U252">2</span>)</span> = <span class="mxinfo " id="T20:U253"><span class="mxinfo " id="T14:U254"><span class="var type1" id="S15T11U464">Points</span>(<span class="mxinfo " id="T7:U256">2</span>,<span class="mxinfo " id="T15:U257"><span class="mxinfo " id="T7:U258">1</span>:<span class="var type1" id="S13T7U468">mapCnt</span></span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="mxinfo " id="T7:U260"><span class="var type1" id="S17T7U472">PreprocessingCnt</span>(1,1) = <span class="var type1" id="S13T7U475">mapCnt</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="mxinfo " id="T7:U263"><span class="var type1" id="S37T7U478">f_error0</span> = <span class="mxinfo " id="T7:U265">zeros(1,1)</span></span>;<span class="comment">%错误标志位</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo " id="T21:U266"><span class="var type1" id="S38T21U485">Prep</span> = <span class="mxinfo " id="T21:U268"><span class="fcn" id="F126N18:B487">Preprocess</span>(<span class="mxinfo " id="T13:U269"><span class="var type1" id="S16T13U489">PreprocessingData</span>(<span class="mxinfo " id="T15:U271"><span class="mxinfo " id="T7:U272">1</span>:<span class="var type1" id="S13T7U492">mapCnt</span></span>,<span class="mxinfo " id="T23:U274">1:2</span>)</span>,<span class="var type1" id="S13T7U496">mapCnt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T19:U276"><span class="mxinfo " id="T7:U277"><span class="var type1" id="S38T21U501">Prep</span>.Cnt</span> &gt;= <span class="mxinfo " id="T7:U279">3</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    <span class="mxinfo " id="T13:U280"><span class="mxinfo " id="T13:U281"><span class="var type1" id="S16T13U507">PreprocessingData</span>(<span class="mxinfo " id="T15:U283"><span class="mxinfo " id="T7:U284">1</span>:<span class="mxinfo " id="T7:U285"><span class="var type1" id="S38T21U512">Prep</span>.Cnt</span>(1,1)</span>,<span class="mxinfo " id="T23:U287">1:2</span>)</span> = <span class="mxinfo " id="T24:U288"><span class="mxinfo " id="T22:U289"><span class="var type1" id="S38T21U521">Prep</span>.Preprocessing</span>(<span class="mxinfo " id="T17:U291"><span class="mxinfo " id="T7:U292">1</span>:<span class="mxinfo " id="T7:U293"><span class="var type1" id="S38T21U527">Prep</span>.Cnt</span>(1,1)</span>,<span class="mxinfo " id="T25:U295"><span class="mxinfo " id="T7:U296">1</span>:<span class="mxinfo " id="T7:U297">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">    <span class="mxinfo " id="T7:U298"><span class="var type1" id="S17T7U537">PreprocessingCnt</span>(1,1) = <span class="mxinfo " id="T7:U300"><span class="var type1" id="S38T21U541">Prep</span>.Cnt</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="mxinfo " id="T7:U302"><span class="var type1" id="S37T7U547">f_error0</span>(1,1) = <span class="mxinfo " id="T1:U304">int32(<span class="mxinfo " id="T7:U305">-<span class="mxinfo " id="T7:U306">1</span></span>)</span></span>;<span class="comment">%若此处为1，则程序应停止继续数据处理</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">    <span class="mxinfo " id="T1:U307"><span class="mxinfo " id="T1:U308"><span class="var type1" id="S3T2U557">out</span>.error</span> = <span class="mxinfo " id="T1:U310">int32(<span class="var type1" id="S37T7U561">f_error0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"><span class="comment">%判断顺逆时针并处理</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"><span class="mxinfo " id="T7:U312"><span class="var type1" id="S40T7U565">Clock_Flag</span> = <span class="mxinfo " id="T7:U314">zeros(1,1)</span></span>;<span class="comment">%顺逆时针标志位，0：逆时针，1：顺时针</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"><span class="mxinfo " id="T7:U315"><span class="var type1" id="S41T7U572">FFLOG</span> = <span class="mxinfo " id="T7:U317"><span class="fcn" id="F136N24:B574">judgeClockWise</span>(<span class="mxinfo " id="T20:U318"><span class="var type1" id="S16T13U576">PreprocessingData</span>(<span class="mxinfo " id="T15:U320"><span class="mxinfo " id="T7:U321">1</span>:<span class="var type1" id="S17T7U580">PreprocessingCnt</span>(1,1)</span>,<span class="mxinfo " id="T12:U323">1</span>)</span>,<span class="mxinfo " id="T20:U324"><span class="var type1" id="S16T13U585">PreprocessingData</span>(<span class="mxinfo " id="T15:U326"><span class="mxinfo " id="T7:U327">1</span>:<span class="var type1" id="S17T7U589">PreprocessingCnt</span>(1,1)</span>,<span class="mxinfo " id="T12:U329">2</span>)</span>,<span class="var type1" id="S17T7U594">PreprocessingCnt</span>(1,1))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T19:U331"><span class="var type1" id="S41T7U601">FFLOG</span>(1,1) == <span class="mxinfo " id="T7:U333">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo " id="T13:U334"><span class="mxinfo " id="T13:U335"><span class="var type1" id="S16T13U608">PreprocessingData</span>(<span class="mxinfo " id="T15:U337"><span class="mxinfo " id="T7:U338">1</span>:<span class="var type1" id="S17T7U612">PreprocessingCnt</span>(1,1)</span>,<span class="mxinfo " id="T23:U340">1:2</span>)</span> = <span class="mxinfo " id="T13:U341">flipud(<span class="mxinfo " id="T13:U342"><span class="var type1" id="S16T13U621">PreprocessingData</span>(<span class="mxinfo " id="T15:U344"><span class="mxinfo " id="T7:U345">1</span>:<span class="var type1" id="S17T7U625">PreprocessingCnt</span>(1,1)</span>,<span class="mxinfo " id="T23:U347">1:2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo " id="T7:U348"><span class="var type1" id="S22T7U634">Monolateral</span>(1,1) = <span class="mxinfo " id="T7:U350"><span class="var type1" id="S17T7U639">PreprocessingCnt</span>(1,1) - <span class="var type1" id="S22T7U643">Monolateral</span>(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">    <span class="mxinfo " id="T7:U353"><span class="var type1" id="S40T7U649">Clock_Flag</span>(1,1) = <span class="mxinfo " id="T7:U355">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo " id="T13:U356"><span class="mxinfo " id="T13:U357"><span class="var type1" id="S16T13U657">PreprocessingData</span>(<span class="mxinfo " id="T15:U359"><span class="mxinfo " id="T7:U360">1</span>:<span class="var type1" id="S17T7U661">PreprocessingCnt</span>(1,1)</span>,<span class="mxinfo " id="T23:U362">1:2</span>)</span> = <span class="mxinfo " id="T13:U363"><span class="var type1" id="S16T13U668">PreprocessingData</span>(<span class="mxinfo " id="T15:U365"><span class="mxinfo " id="T7:U366">1</span>:<span class="var type1" id="S17T7U672">PreprocessingCnt</span>(1,1)</span>,<span class="mxinfo " id="T25:U368"><span class="mxinfo " id="T7:U369">1</span>:<span class="mxinfo " id="T7:U370">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    <span class="comment">%PreprocessingCnt(1,1) = PreprocessingCnt(1,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    <span class="mxinfo " id="T7:U371"><span class="var type1" id="S40T7U681">Clock_Flag</span>(1,1) = <span class="mxinfo " id="T7:U373">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="comment">%% 判断边界线相交,则退出算法</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="mxinfo " id="T26:U374"><span class="var type1" id="S44T26U687">PP</span> = <span class="mxinfo " id="T26:U376">zeros(<span class="mxinfo " id="T7:U377"><span class="var type1" id="S10T7U691">MAX_MAP_POINTS</span>/2</span>,<span class="mxinfo " id="T7:U379">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line"><span class="mxinfo " id="T27:U380"><span class="var type1" id="S45T27U696">PPP</span> = <span class="mxinfo " id="T27:U382">zeros(<span class="var type1" id="S10T7U699">MAX_MAP_POINTS</span>,<span class="mxinfo " id="T7:U384">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"><span class="mxinfo " id="T7:U385"><span class="var type1" id="S46T7U703">PP_Cnt</span> = <span class="mxinfo " id="T7:U387">zeros(1,1)</span></span>;<span class="comment">%交点个数</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"><span class="mxinfo " id="T7:U388"><span class="var type1" id="S47T7U710">PPP_Cnt</span> = <span class="mxinfo " id="T7:U390">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">[<span class="mxinfo " id="T26:U391"><span class="var type1" id="S44T26U719">PP</span>(<span class="mxinfo " id="T28:U393"><span class="mxinfo " id="T7:U394">1</span>:<span class="mxinfo " id="T7:U395">50</span></span>,<span class="mxinfo " id="T29:U396"><span class="mxinfo " id="T7:U397">1</span>:<span class="mxinfo " id="T7:U398">7</span></span>)</span>,<span class="mxinfo " id="T7:U399"><span class="var type1" id="S46T7U727">PP_Cnt</span>(1,1)</span>,<span class="mxinfo " id="T27:U401"><span class="var type1" id="S45T27U731">PPP</span>(<span class="mxinfo " id="T5:U403"><span class="mxinfo " id="T7:U404">1</span>:<span class="mxinfo " id="T7:U405">100</span></span>,<span class="mxinfo " id="T29:U406"><span class="mxinfo " id="T7:U407">1</span>:<span class="mxinfo " id="T7:U408">7</span></span>)</span>,<span class="mxinfo " id="T7:U409"><span class="var type1" id="S47T7U739">PPP_Cnt</span>(1,1)</span>] = <span class="fcn" id="F176N13:B743">Calculate_New_Indented_Boundary_Point</span>(<span class="mxinfo " id="T13:U411"><span class="var type1" id="S16T13U745">PreprocessingData</span>(<span class="mxinfo " id="T15:U413"><span class="mxinfo " id="T7:U414">1</span>:<span class="var type1" id="S17T7U748">PreprocessingCnt</span></span>,<span class="mxinfo " id="T23:U416">1:2</span>)</span>,<span class="var type1" id="S17T7U752">PreprocessingCnt</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T19:U418"><span class="var type1" id="S46T7U757">PP_Cnt</span>(1,1) ~= <span class="mxinfo " id="T7:U420">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo " id="T7:U421"><span class="var type1" id="S37T7U764">f_error0</span>(1,1) = <span class="mxinfo " id="T1:U423">int32(<span class="mxinfo " id="T7:U424">-<span class="mxinfo " id="T7:U425">1</span></span>)</span></span>;<span class="comment">%若此处为1，则程序应停止继续数据处理</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">    <span class="mxinfo " id="T1:U426"><span class="mxinfo " id="T1:U427"><span class="var type1" id="S3T2U774">out</span>.error</span> = <span class="mxinfo " id="T1:U429">int32(<span class="var type1" id="S37T7U778">f_error0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"><span class="comment">%% 调用功能函数</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="comment">%经单边操作（内部已经进行了去除无效环和把点变成顺时针的形式）</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo " id="T13:U431"><span class="var type1" id="S49T13U782">PointOut</span> = <span class="mxinfo " id="T13:U433"><span class="var type1" id="S16T13U784">PreprocessingData</span>(<span class="mxinfo " id="T15:U435"><span class="mxinfo " id="T7:U436">1</span>:<span class="var type1" id="S17T7U787">PreprocessingCnt</span></span>,<span class="mxinfo " id="T25:U438"><span class="mxinfo " id="T7:U439">1</span>:<span class="mxinfo " id="T7:U440">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo " id="T7:U441"><span class="var type1" id="S50T7U793">P_Cnt</span> = <span class="var type1" id="S17T7U794">PreprocessingCnt</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="keyword">if</span> eq(<span class="var type1" id="S37T7U800">f_error0</span>(1,1),0)</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">    <span class="mxinfo " id="T7:U445"><span class="var type1" id="S52T7U806">f_Warning1</span> = <span class="mxinfo " id="T7:U447">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">    <span class="mxinfo " id="T7:U448"><span class="var type1" id="S53T7U813">f_Warning2</span> = <span class="mxinfo " id="T7:U450">zeros(1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">    <span class="comment">%单边移动</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T19:U451"><span class="var type1" id="S23T7U821">Monolateral_L</span> ~= <span class="mxinfo " id="T7:U453">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">        [<span class="var type1" id="S49T13U826">PointOut</span>,<span class="var type1" id="S50T7U827">P_Cnt</span>,<span class="var type1" id="S52T7U828">f_Warning1</span>] = <span class="fcn" id="F323N12:B830">Calculate_Monolateral_Points</span>(<span class="mxinfo " id="T13:U457"><span class="var type1" id="S16T13U832">PreprocessingData</span>(<span class="mxinfo " id="T15:U459"><span class="mxinfo " id="T7:U460">1</span>:<span class="var type1" id="S17T7U835">PreprocessingCnt</span></span>,<span class="mxinfo " id="T23:U462">1:2</span>)</span>,<span class="var type1" id="S17T7U839">PreprocessingCnt</span>,<span class="var type1" id="S22T7U840">Monolateral</span>,<span class="var type1" id="S23T7U841">Monolateral_L</span>,<span class="var type1" id="S24T7U842">Monolateral_flag</span>,<span class="var type1" id="S40T7U844">Clock_Flag</span>(1,1));<span class="comment">%但不可把某个便便给缩没了</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">    <span class="comment">%整体进行内缩外扩运算</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T19:U468"><span class="var type1" id="S20T7U850">L</span> ~= <span class="mxinfo " id="T7:U470">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">        [<span class="var type1" id="S49T13U855">PointOut</span>,<span class="var type1" id="S50T7U856">P_Cnt</span>,<span class="var type1" id="S53T7U857">f_Warning2</span>] = <span class="fcn" id="F327N11:B859">Calculate_Map_Points</span>(<span class="mxinfo " id="T13:U474"><span class="var type1" id="S49T13U861">PointOut</span>(<span class="mxinfo " id="T15:U476"><span class="mxinfo " id="T7:U477">1</span>:<span class="var type1" id="S50T7U864">P_Cnt</span></span>,<span class="mxinfo " id="T23:U479">1:2</span>)</span>,<span class="var type1" id="S50T7U868">P_Cnt</span>,<span class="var type1" id="S20T7U869">L</span>,<span class="var type1" id="S21T7U870">flag</span>,<span class="var type1" id="S25T7U871">Theita</span>,<span class="var type1" id="S40T7U873">Clock_Flag</span>(1,1));</span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">    <span class="var type0" id="S52T0U879">f_Warning1</span> = zeros(1,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">    <span class="var type0" id="S53T0U886">f_Warning2</span> = zeros(1,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="comment">%% 画图</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line"><span class="keyword">if</span> 0</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">    figure</span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">    hold <span class="string">on</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">    plot([PreprocessingData(1:PreprocessingCnt,1)], [PreprocessingData(1:PreprocessingCnt,2)],<span class="string">'*-'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">    plot([PointOut(1:P_Cnt,1)], [PointOut(1:P_Cnt,2)],<span class="string">'*-'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line"><span class="comment">%% 平面转经纬度</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="mxinfo " id="T4:U485"><span class="mxinfo " id="T4:U486"><span class="var type1" id="S4T3U942">mapOut</span>.mapCnt</span> = <span class="mxinfo " id="T4:U488">uint8(<span class="var type1" id="S50T7U947">P_Cnt</span>(1,1))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T19:U490"><span class="var type1" id="S26T7U954">mapFlag</span>(1,1) == <span class="mxinfo " id="T7:U492">0</span></span><span class="comment">%1为经纬度坐标，0为平面坐标</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">    <span class="mxinfo " id="T16:U493"><span class="mxinfo " id="T16:U494"><span class="mxinfo " id="T5:U495"><span class="var type1" id="S4T3U962">mapOut</span>.mapLat</span>(<span class="mxinfo " id="T12:U497">1</span>,<span class="mxinfo " id="T17:U498"><span class="mxinfo " id="T7:U499">1</span>:<span class="var type1" id="S50T7U968">P_Cnt</span>(1,1)</span>)</span> = <span class="mxinfo " id="T14:U501"><span class="mxinfo " id="T20:U502"><span class="var type1" id="S49T13U973">PointOut</span>(<span class="mxinfo " id="T15:U504"><span class="mxinfo " id="T7:U505">1</span>:<span class="var type1" id="S50T7U977">P_Cnt</span>(1,1)</span>,<span class="mxinfo " id="T7:U507">1</span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">    <span class="mxinfo " id="T16:U508"><span class="mxinfo " id="T16:U509"><span class="mxinfo " id="T5:U510"><span class="var type1" id="S4T3U985">mapOut</span>.mapLon</span>(<span class="mxinfo " id="T12:U512">1</span>,<span class="mxinfo " id="T17:U513"><span class="mxinfo " id="T7:U514">1</span>:<span class="var type1" id="S50T7U991">P_Cnt</span>(1,1)</span>)</span> = <span class="mxinfo " id="T14:U516"><span class="mxinfo " id="T20:U517"><span class="var type1" id="S49T13U996">PointOut</span>(<span class="mxinfo " id="T15:U519"><span class="mxinfo " id="T7:U520">1</span>:<span class="var type1" id="S50T7U1000">P_Cnt</span>(1,1)</span>,<span class="mxinfo " id="T7:U522">2</span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T19:U523"><span class="var type1" id="S26T7U1007">mapFlag</span>(1,1) == <span class="mxinfo " id="T7:U525">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S8T7U1014">mapTransfMethod</span> == 1<span class="comment">%算法1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">        <span class="keyword">for</span> <span class="var type0" id="S35T0U1018">i</span>=1:sum(<span class="var type0" id="S4T0U1024">mapOut</span>.mapCnt)</span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line">             <span class="var type0" id="S4T0U1030">mapOut</span>.mapLat(<span class="var type0" id="S35T0U1032">i</span>) = <span class="var type0" id="S49T0U1038">PointOut</span>(<span class="var type0" id="S35T0U1039">i</span>,1)*180/pi/<span class="var type0" id="S30T0U1044">earthR</span> + <span class="var type0" id="S28T0U1045">refLat</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">             <span class="var type0" id="S4T0U1050">mapOut</span>.mapLon(<span class="var type0" id="S35T0U1052">i</span>) = <span class="var type0" id="S49T0U1058">PointOut</span>(<span class="var type0" id="S35T0U1059">i</span>,2)*180/pi/<span class="var type0" id="S31T0U1064">latR</span> + <span class="var type0" id="S29T0U1065">refLon</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S35T7U1069">i</span>=<span class="mxinfo " id="T7:U528">1</span>:<span class="mxinfo " id="T7:U529">sum(<span class="mxinfo " id="T4:U530"><span class="var type1" id="S4T3U1075">mapOut</span>.mapCnt</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">         [<span class="mxinfo " id="T7:U532"><span class="mxinfo " id="T5:U533"><span class="var type1" id="S4T3U1082">mapOut</span>.mapLat</span>(<span class="var type1" id="S35T7U1084">i</span>)</span>,<span class="mxinfo " id="T7:U536"><span class="mxinfo " id="T5:U537"><span class="var type1" id="S4T3U1087">mapOut</span>.mapLon</span>(<span class="var type1" id="S35T7U1089">i</span>)</span>] = <span class="fcn" id="F352N21:B1091">XY2BL</span>(<span class="mxinfo " id="T7:U540"><span class="var type1" id="S49T13U1093">PointOut</span>(<span class="var type1" id="S35T7U1094">i</span>,<span class="mxinfo " id="T12:U543">1</span>)</span>,<span class="mxinfo " id="T7:U544"><span class="var type1" id="S49T13U1097">PointOut</span>(<span class="var type1" id="S35T7U1098">i</span>,<span class="mxinfo " id="T12:U547">2</span>)</span>,<span class="var type1" id="S27T7U1100">L0</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">       <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">    <span class="mxinfo " id="T7:U549"><span class="var type1" id="S34T7U1105">f_Warning0</span>(1,1) = <span class="mxinfo " id="T7:U551">1</span></span>;<span class="comment">%警告标志位</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line"><span class="comment">%% 输出赋值</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line"><span class="mxinfo " id="T1:U552"><span class="mxinfo " id="T1:U553"><span class="var type1" id="S3T2U1112">out</span>.error</span> = <span class="mxinfo " id="T1:U555">int32(<span class="var type1" id="S37T7U1116">f_error0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line"><span class="keyword">if</span> <span class="var type1" id="S34T7U1121">f_Warning0</span> || <span class="var type1" id="S52T7U1122">f_Warning1</span> || <span class="mxinfo " id="T19:U559"><span class="var type1" id="S53T7U1124">f_Warning2</span> == <span class="mxinfo " id="T7:U561">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">    <span class="mxinfo " id="T1:U562"><span class="mxinfo " id="T1:U563"><span class="var type1" id="S3T2U1129">out</span>.warn</span> = <span class="mxinfo " id="T1:U565">int32(<span class="mxinfo " id="T7:U566">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line"></span></span>
</pre>
