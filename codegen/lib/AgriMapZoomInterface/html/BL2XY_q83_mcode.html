<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="34,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">%L经度，B纬度</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%采用任意带，任意带的中心经线L0，由用户输入</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,3" id="srcline3"> 3</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T7U3">x</span>,<span class="var type1" id="S3T7U4">y</span>] = BL2XY_q(<span class="var type1" id="S4T7U7">B</span>,<span class="var type1" id="S5T7U8">L</span>,<span class="var type1" id="S6T7U9">L0</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="34,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% 此函数用于进行高斯正算</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="34,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%使用WGS-84椭球</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T7:U6"><span class="var type1" id="S7T7U12">a</span>=<span class="mxinfo " id="T7:U8">6378137</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T7:U9"><span class="var type1" id="S8T7U16">b</span>=<span class="mxinfo " id="T7:U11">6356752.3142</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T7:U12"><span class="var type1" id="S9T7U20">e</span>=<span class="mxinfo " id="T7:U14">(sqrt(<span class="var type1" id="S7T7U27">a</span>^2-<span class="var type1" id="S8T7U30">b</span>^2))/<span class="var type1" id="S7T7U32">a</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,10" id="srcline10">10</a></span><span class="line"><span class="comment">% e1=(sqrt(a^2-b^2))/b; </span></span></span>
<span class="srcline"><span class="lineno"><a href="34,11" id="srcline11">11</a></span><span class="line"><span class="comment">%k=3;%使用3度带</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="34,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T7:U18"><span class="var type1" id="S11T7U35">ee</span>=<span class="mxinfo " id="T7:U20"><span class="var type1" id="S9T7U37">e</span>/sqrt(1-<span class="var type1" id="S9T7U43">e</span>^2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,14" id="srcline14">14</a></span><span class="line"><span class="comment">% 计算中央子午线经度</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,15" id="srcline15">15</a></span><span class="line"><span class="comment">% if k==6</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,16" id="srcline16">16</a></span><span class="line"><span class="comment">%     L0=6*(fix(L/6)+1)-3;</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,17" id="srcline17">17</a></span><span class="line"><span class="comment">% elseif k==3</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,18" id="srcline18">18</a></span><span class="line"><span class="comment">%     L0=3*(fix((L-1.5)/3)+1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,19" id="srcline19">19</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,20" id="srcline20">20</a></span><span class="line"><span class="comment">%采用任意带，任意带的中心经线L0，由用户输入</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T7:U23"><span class="var type1" id="S12T7U47">LP</span>=<span class="mxinfo " id="T7:U25"><span class="mxinfo " id="T7:U26">(<span class="mxinfo " id="T7:U27"><span class="var type1" id="S5T7U52">L</span>-<span class="var type1" id="S6T7U53">L0</span></span>)/<span class="mxinfo " id="T7:U30">180</span></span>*<span class="mxinfo " id="T7:U31">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T7:U32"><span class="var type1" id="S4T7U59">B</span>=<span class="mxinfo " id="T7:U34"><span class="mxinfo " id="T7:U35"><span class="var type1" id="S4T7U62">B</span>/<span class="mxinfo " id="T7:U37">180</span></span>*<span class="mxinfo " id="T7:U38">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="34,24" id="srcline24">24</a></span><span class="line"><span class="comment">% 计算子午圈弧长</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T7:U39"><span class="var type1" id="S14T7U68">ap</span>=<span class="mxinfo " id="T7:U41">1+3/4*<span class="var type1" id="S9T7U80">e</span>^2+45/64*<span class="var type1" id="S9T7U87">e</span>^4+175/256*<span class="var type1" id="S9T7U94">e</span>^6+11025/16384*<span class="var type1" id="S9T7U101">e</span>^8+43659/65536*<span class="var type1" id="S9T7U108">e</span>^10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T7:U47"><span class="var type1" id="S15T7U112">bp</span>=<span class="mxinfo " id="T7:U49">3/4*<span class="var type1" id="S9T7U122">e</span>^2+15/16*<span class="var type1" id="S9T7U129">e</span>^4+525/512*<span class="var type1" id="S9T7U136">e</span>^6+2205/2048*<span class="var type1" id="S9T7U143">e</span>^8+72765/65536*<span class="var type1" id="S9T7U150">e</span>^10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T7:U55"><span class="var type1" id="S16T7U154">cp</span>=<span class="mxinfo " id="T7:U57">15/64*<span class="var type1" id="S9T7U163">e</span>^4+105/256*<span class="var type1" id="S9T7U170">e</span>^6+2205/4096*<span class="var type1" id="S9T7U177">e</span>^8+10395/16384*<span class="var type1" id="S9T7U184">e</span>^10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo " id="T7:U62"><span class="var type1" id="S17T7U188">dp</span>=<span class="mxinfo " id="T7:U64">35/512*<span class="var type1" id="S9T7U196">e</span>^6+315/2048*<span class="var type1" id="S9T7U203">e</span>^8+31185/131072*<span class="var type1" id="S9T7U210">e</span>^10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo " id="T7:U68"><span class="var type1" id="S18T7U214">ep</span>=<span class="mxinfo " id="T7:U70">315/16384*<span class="var type1" id="S9T7U221">e</span>^8+3465/65536*<span class="var type1" id="S9T7U228">e</span>^10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T7:U73"><span class="var type1" id="S19T7U232">fp</span>=<span class="mxinfo " id="T7:U75">639/131072*<span class="var type1" id="S9T7U238">e</span>^10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo " id="T7:U77"><span class="var type1" id="S20T7U242">X</span>=<span class="mxinfo " id="T7:U79"><span class="mxinfo " id="T7:U80"><span class="var type1" id="S7T7U245">a</span>*(<span class="mxinfo " id="T7:U82"><span class="mxinfo " id="T7:U83">1</span>-<span class="mxinfo " id="T7:U84"><span class="var type1" id="S9T7U250">e</span>^2</span></span>)</span>*(<span class="mxinfo " id="T7:U86"><span class="mxinfo " id="T7:U87"><span class="mxinfo " id="T7:U88"><span class="mxinfo " id="T7:U89"><span class="mxinfo " id="T7:U90"><span class="mxinfo " id="T7:U91"><span class="var type1" id="S14T7U259">ap</span>*<span class="var type1" id="S4T7U260">B</span></span>-<span class="mxinfo " id="T7:U94"><span class="mxinfo " id="T7:U95"><span class="var type1" id="S15T7U263">bp</span>/<span class="mxinfo " id="T7:U97">2</span></span>*<span class="mxinfo " id="T7:U98">sin(<span class="mxinfo " id="T7:U99"><span class="mxinfo " id="T7:U100">2</span>*<span class="var type1" id="S4T7U269">B</span></span>)</span></span></span>+<span class="mxinfo " id="T7:U102"><span class="mxinfo " id="T7:U103"><span class="var type1" id="S16T7U272">cp</span>/<span class="mxinfo " id="T7:U105">4</span></span>*<span class="mxinfo " id="T7:U106">sin(<span class="mxinfo " id="T7:U107"><span class="mxinfo " id="T7:U108">4</span>*<span class="var type1" id="S4T7U278">B</span></span>)</span></span></span>-<span class="mxinfo " id="T7:U110"><span class="mxinfo " id="T7:U111"><span class="var type1" id="S17T7U281">dp</span>/<span class="mxinfo " id="T7:U113">6</span></span>*<span class="mxinfo " id="T7:U114">sin(<span class="mxinfo " id="T7:U115"><span class="mxinfo " id="T7:U116">6</span>*<span class="var type1" id="S4T7U287">B</span></span>)</span></span></span>+<span class="mxinfo " id="T7:U118"><span class="mxinfo " id="T7:U119"><span class="var type1" id="S18T7U290">ep</span>/<span class="mxinfo " id="T7:U121">8</span></span>*<span class="mxinfo " id="T7:U122">sin(<span class="mxinfo " id="T7:U123"><span class="mxinfo " id="T7:U124">8</span>*<span class="var type1" id="S4T7U296">B</span></span>)</span></span></span>-<span class="mxinfo " id="T7:U126"><span class="mxinfo " id="T7:U127"><span class="var type1" id="S19T7U299">fp</span>/<span class="mxinfo " id="T7:U129">10</span></span>*<span class="mxinfo " id="T7:U130">sin(<span class="mxinfo " id="T7:U131"><span class="mxinfo " id="T7:U132">10</span>*<span class="var type1" id="S4T7U305">B</span></span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,32" id="srcline32">32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="34,33" id="srcline33">33</a></span><span class="line"><span class="comment">% 计算高斯平面坐标</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T7:U134"><span class="var type1" id="S22T7U308">N</span>=<span class="mxinfo " id="T7:U136"><span class="var type1" id="S7T7U310">a</span>/<span class="mxinfo " id="T7:U138">sqrt(<span class="mxinfo " id="T7:U139"><span class="mxinfo " id="T7:U140">1</span>-<span class="mxinfo " id="T7:U141"><span class="mxinfo " id="T7:U142"><span class="mxinfo " id="T7:U143"><span class="var type1" id="S9T7U318">e</span>^2</span>*<span class="mxinfo " id="T7:U145">sin(<span class="var type1" id="S4T7U322">B</span>)</span></span>*<span class="mxinfo " id="T7:U147">sin(<span class="var type1" id="S4T7U325">B</span>)</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T7:U149"><span class="var type1" id="S23T7U328">eta</span>=<span class="mxinfo " id="T7:U151"><span class="var type1" id="S11T7U330">ee</span>*<span class="mxinfo " id="T7:U153">cos(<span class="var type1" id="S4T7U333">B</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T7:U155"><span class="var type1" id="S25T7U336">t</span>=<span class="mxinfo " id="T7:U157">tan(<span class="var type1" id="S4T7U339">B</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T7:U159"><span class="var type1" id="S27T7U342">m</span>=<span class="mxinfo " id="T7:U161"><span class="mxinfo " id="T7:U162">cos(<span class="var type1" id="S4T7U346">B</span>)</span>*<span class="var type1" id="S12T7U347">LP</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T7:U165"><span class="var type1" id="S2T7U350">x</span>=<span class="mxinfo " id="T7:U167"><span class="var type1" id="S20T7U352">X</span>+<span class="mxinfo " id="T7:U169"><span class="mxinfo " id="T7:U170"><span class="var type1" id="S22T7U355">N</span>*<span class="var type1" id="S25T7U356">t</span></span>*(<span class="mxinfo " id="T7:U173"><span class="mxinfo " id="T7:U174"><span class="mxinfo " id="T7:U175"><span class="mxinfo " id="T7:U176">0.5</span>*<span class="mxinfo " id="T7:U177"><span class="var type1" id="S27T7U363">m</span>^2</span></span>+<span class="mxinfo " id="T7:U179"><span class="mxinfo " id="T7:U180"><span class="mxinfo " id="T7:U181"><span class="mxinfo " id="T7:U182">1</span>/<span class="mxinfo " id="T7:U183">24</span></span>*(<span class="mxinfo " id="T7:U184"><span class="mxinfo " id="T7:U185"><span class="mxinfo " id="T7:U186"><span class="mxinfo " id="T7:U187">5</span>-<span class="mxinfo " id="T7:U188"><span class="var type1" id="S25T7U376">t</span>^2</span></span>+<span class="mxinfo " id="T7:U190"><span class="mxinfo " id="T7:U191">9</span>*<span class="mxinfo " id="T7:U192"><span class="var type1" id="S23T7U381">eta</span>^2</span></span></span>+<span class="mxinfo " id="T7:U194"><span class="mxinfo " id="T7:U195">4</span>*<span class="mxinfo " id="T7:U196"><span class="var type1" id="S23T7U386">eta</span>^4</span></span></span>)</span>*<span class="mxinfo " id="T7:U198"><span class="var type1" id="S27T7U389">m</span>^4</span></span></span>+<span class="mxinfo " id="T7:U200"><span class="mxinfo " id="T7:U201"><span class="mxinfo " id="T7:U202"><span class="mxinfo " id="T7:U203">1</span>/<span class="mxinfo " id="T7:U204">720</span></span>*(<span class="mxinfo " id="T7:U205"><span class="mxinfo " id="T7:U206"><span class="mxinfo " id="T7:U207">61</span>-<span class="mxinfo " id="T7:U208"><span class="mxinfo " id="T7:U209">58</span>*<span class="mxinfo " id="T7:U210"><span class="var type1" id="S25T7U403">t</span>^2</span></span></span>+<span class="mxinfo " id="T7:U212"><span class="var type1" id="S25T7U406">t</span>^4</span></span>)</span>*<span class="mxinfo " id="T7:U214"><span class="var type1" id="S27T7U409">m</span>^6</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo " id="T7:U216"><span class="var type1" id="S3T7U413">y</span>=<span class="mxinfo " id="T7:U218"><span class="var type1" id="S22T7U415">N</span>*(<span class="mxinfo " id="T7:U220"><span class="mxinfo " id="T7:U221"><span class="var type1" id="S27T7U419">m</span>+<span class="mxinfo " id="T7:U223"><span class="mxinfo " id="T7:U224"><span class="mxinfo " id="T7:U225"><span class="mxinfo " id="T7:U226">1</span>/<span class="mxinfo " id="T7:U227">6</span></span>*(<span class="mxinfo " id="T7:U228"><span class="mxinfo " id="T7:U229"><span class="mxinfo " id="T7:U230">1</span>-<span class="mxinfo " id="T7:U231"><span class="var type1" id="S25T7U430">t</span>^2</span></span>+<span class="mxinfo " id="T7:U233"><span class="var type1" id="S23T7U433">eta</span>^2</span></span>)</span>*<span class="mxinfo " id="T7:U235"><span class="var type1" id="S27T7U436">m</span>^3</span></span></span>+<span class="mxinfo " id="T7:U237"><span class="mxinfo " id="T7:U238"><span class="mxinfo " id="T7:U239"><span class="mxinfo " id="T7:U240">1</span>/<span class="mxinfo " id="T7:U241">120</span></span>*(<span class="mxinfo " id="T7:U242"><span class="mxinfo " id="T7:U243"><span class="mxinfo " id="T7:U244"><span class="mxinfo " id="T7:U245"><span class="mxinfo " id="T7:U246">5</span>-<span class="mxinfo " id="T7:U247"><span class="mxinfo " id="T7:U248">18</span>*<span class="mxinfo " id="T7:U249"><span class="var type1" id="S25T7U452">t</span>^2</span></span></span>+<span class="mxinfo " id="T7:U251"><span class="var type1" id="S25T7U455">t</span>^4</span></span>+<span class="mxinfo " id="T7:U253"><span class="mxinfo " id="T7:U254">14</span>*<span class="mxinfo " id="T7:U255"><span class="var type1" id="S23T7U460">eta</span>^2</span></span></span>-<span class="mxinfo " id="T7:U257"><span class="mxinfo " id="T7:U258"><span class="mxinfo " id="T7:U259">58</span>*<span class="mxinfo " id="T7:U260"><span class="var type1" id="S23T7U466">eta</span>^2</span></span>*<span class="mxinfo " id="T7:U262"><span class="var type1" id="S25T7U469">t</span>^2</span></span></span>)</span>*<span class="mxinfo " id="T7:U264"><span class="var type1" id="S27T7U472">m</span>^5</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="34,40" id="srcline40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="34,41" id="srcline41">41</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="34,42" id="srcline42">42</a></span><span class="line"></span></span>
</pre>
